<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Data2Excel.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Data2Excel</a> &gt; <a href="index.source.html" class="el_package">cn.genomics.datatools</a> &gt; <span class="el_source">Data2Excel.java</span></div><h1>Data2Excel.java</h1><pre class="source lang-java linenums">package cn.genomics.datatools;

import gnu.getopt.Getopt;
import gnu.getopt.LongOpt;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.HashMap;
import java.util.Iterator;
import java.util.Map;

import org.apache.poi.ss.usermodel.CellStyle;
import org.apache.poi.ss.usermodel.IndexedColors;
import org.apache.poi.ss.util.CellRangeAddress;
import org.apache.poi.xssf.usermodel.XSSFCell;
import org.apache.poi.xssf.usermodel.XSSFFont;
import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

<span class="nc" id="L24">public class Data2Excel {</span>

<span class="fc" id="L26">	static int MAX_COLUMN_SUPPORT = GlobleDefined.getMaxColumn();</span>
<span class="fc" id="L27">	static boolean no_color = false;</span>
//	static int[] col_width = new int[MAX_COLUMN_SUPPORT];
<span class="fc" id="L29">	static String formatfile = null;</span>
	
	public static void main(String[] args) throws FileNotFoundException,
			IOException {
<span class="nc" id="L33">		LongOpt[] longopts = new LongOpt[10];</span>
<span class="nc" id="L34">		longopts[0] = new LongOpt(&quot;help&quot;, LongOpt.NO_ARGUMENT, null, 'h');</span>
<span class="nc" id="L35">		longopts[1] = new LongOpt(&quot;infile&quot;, LongOpt.REQUIRED_ARGUMENT, null,'i');</span>
<span class="nc" id="L36">		longopts[2] = new LongOpt(&quot;outfile&quot;, LongOpt.REQUIRED_ARGUMENT, null,'o');</span>
<span class="nc" id="L37">		longopts[3] = new LongOpt(&quot;in_excel_col&quot;, LongOpt.OPTIONAL_ARGUMENT, null, 'e');</span>
<span class="nc" id="L38">		longopts[4] = new LongOpt(&quot;no_color&quot;, LongOpt.NO_ARGUMENT, null, 'c');</span>
<span class="nc" id="L39">		longopts[5] = new LongOpt(&quot;sheet_name&quot;, LongOpt.REQUIRED_ARGUMENT, null, 's');</span>
<span class="nc" id="L40">		longopts[6] = new LongOpt(&quot;format&quot;, LongOpt.REQUIRED_ARGUMENT, null, 'f');</span>
<span class="nc" id="L41">		longopts[7] = new LongOpt(&quot;print_sheet&quot;, LongOpt.REQUIRED_ARGUMENT, null, 'p');</span>
<span class="nc" id="L42">		longopts[8] = new LongOpt(&quot;split&quot;, LongOpt.REQUIRED_ARGUMENT, null, 'F');</span>
		

<span class="nc" id="L45">		 int c , in_excel = -2 ,infile_num = 0, sheetIndexToPrint = -1;</span>
<span class="nc" id="L46">    	 String outfile = null, sheet_name = null;</span>
<span class="nc" id="L47">    	 String[] infiles = new String[20];</span>
<span class="nc" id="L48">		 Getopt g = new Getopt(&quot;Data2Excel&quot;, args, &quot;-:i:o:f:s:e::p:F:ch&quot;, longopts);</span>
<span class="nc bnc" id="L49" title="All 2 branches missed.">		 if(args.length ==0)	usage();</span>
		 
<span class="nc bnc" id="L51" title="All 2 branches missed.">		 while ((c = g.getopt()) != -1)</span>
		 {
<span class="nc bnc" id="L53" title="All 10 branches missed.">			 switch(c)</span>
			 {
				 case 'i': 
<span class="nc" id="L56">					 infiles[infile_num++] = g.getOptarg();break;</span>
				 case 'o':
<span class="nc" id="L58">					 outfile = g.getOptarg();break;</span>
				 case 'f':
<span class="nc" id="L60">					 formatfile = g.getOptarg();break;</span>
				 case 's':
<span class="nc" id="L62">					 sheet_name = g.getOptarg();break;</span>
				 case 'p':
<span class="nc" id="L64">					 sheetIndexToPrint = Integer.parseInt(g.getOptarg());break;</span>
				 case 'F':
<span class="nc" id="L66">					 GlobleDefined.setSplitChar(g.getOptarg());break;</span>
				 case 'e':
<span class="nc bnc" id="L68" title="All 2 branches missed.">					 if(g.getOptarg() == null) in_excel = -1;</span>
<span class="nc" id="L69">					 else in_excel = Integer.parseInt(g.getOptarg());break;</span>
				 case 'c':
<span class="nc" id="L71">					 no_color = true;break;</span>
				 case 'h':
<span class="nc" id="L73">					 usage();</span>
			 }			 
		 }
		 
<span class="nc bnc" id="L77" title="All 4 branches missed.">		if(infiles.length == 0 || infiles[0] == null) usage();</span>
<span class="nc bnc" id="L78" title="All 4 branches missed.">		if(infiles[0].endsWith(&quot;.xlsx&quot;) || infiles[0].endsWith(&quot;.xlsm&quot;))</span>
		{
<span class="nc" id="L80">			ReadXLSX excelfile = new ReadXLSX();</span>
<span class="nc" id="L81">			excelfile.readExcel(new FileInputStream(new File(infiles[0])),sheetIndexToPrint);</span>
<span class="nc" id="L82">			System.exit(0);			</span>
<span class="nc bnc" id="L83" title="All 2 branches missed.">		}else if(infiles[0].endsWith(&quot;.xls&quot;)){</span>
<span class="nc" id="L84">			ReadXLS xlsfile = new ReadXLS();</span>
<span class="nc" id="L85">			xlsfile.readExcel(new FileInputStream(new File(infiles[0])),sheetIndexToPrint);</span>
<span class="nc" id="L86">			System.exit(0);</span>
		}
		
		
<span class="nc bnc" id="L90" title="All 2 branches missed.">		if(outfile == null)  outfile = infiles[0]+&quot;.xlsx&quot;;</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">		else if(!outfile.endsWith(&quot;.xlsx&quot;))	 outfile = outfile+&quot;.xlsx&quot;;</span>
		
<span class="nc" id="L93">		XSSFWorkbook wb = new XSSFWorkbook();		</span>

<span class="nc" id="L95">		XSSFFont headerFont = wb.createFont();</span>
<span class="nc" id="L96">		headerFont.setFontHeightInPoints((short) 14);</span>
<span class="nc" id="L97">		headerFont.setBold(true);</span>
		
<span class="nc" id="L99">		CellStyle textStyle = wb.createCellStyle();</span>
<span class="nc" id="L100">		textStyle.setFillForegroundColor(IndexedColors.LIGHT_GREEN.getIndex());</span>
<span class="nc" id="L101">		textStyle.setFillPattern(CellStyle.SOLID_FOREGROUND);</span>
		
<span class="nc" id="L103">		CellStyle headerStyle = wb.createCellStyle();</span>
<span class="nc" id="L104">		headerStyle.setFont(headerFont);</span>
		
		//set sheet name
<span class="nc" id="L107">		String[] sheetNameArr = new String[20];</span>
<span class="nc bnc" id="L108" title="All 2 branches missed.">		if(sheet_name != null)</span>
		{
<span class="nc" id="L110">			sheetNameArr = sheet_name.split(&quot;,&quot;);</span>
		}
		
<span class="nc bnc" id="L113" title="All 2 branches missed.">		for(int n = 0;infiles[n]!=null;n++)</span>
		{
<span class="nc" id="L115">			System.out.println(infiles[n]+&quot;\t&quot;+&quot;writing...&quot;);</span>
			XSSFSheet sheet;
<span class="nc bnc" id="L117" title="All 4 branches missed.">			if(sheet_name != null &amp;&amp; sheetNameArr[n] != null)</span>
			{
<span class="nc" id="L119">				sheet = wb.createSheet(sheetNameArr[n]);		</span>
			}else
			{
<span class="nc" id="L122">				sheet = wb.createSheet();</span>
			}
//			sheet.setDefaultRowHeight((short)(1.2*256));
<span class="nc bnc" id="L125" title="All 2 branches missed.">			if(in_excel == -2)</span>
<span class="nc" id="L126">				writeToSheet(sheet,infiles[n],headerStyle, textStyle);</span>
<span class="nc bnc" id="L127" title="All 2 branches missed.">			else if(-1 == writeToSheet(sheet,infiles[n],headerStyle, textStyle,in_excel))</span>
<span class="nc" id="L128">				writeToSheet(sheet,infiles[n],headerStyle, textStyle);</span>
			
		}
<span class="nc" id="L131">		FileOutputStream fileOut = new FileOutputStream(outfile);</span>
<span class="nc" id="L132">		wb.write(fileOut);</span>
<span class="nc" id="L133">		wb.close();</span>
<span class="nc" id="L134">		fileOut.close();</span>
<span class="nc" id="L135">	}</span>
	
	private static void usage() {
<span class="nc" id="L138">		System.out.println();</span>
<span class="nc" id="L139">		System.out.println(&quot;Data2Excel version 0.3&quot;);</span>
<span class="nc" id="L140">		System.out.println(&quot;Author: huangzhibo@genomics.cn&quot;);</span>
<span class="nc" id="L141">		System.out.println(&quot;Date  : 2015-7-16&quot;);</span>
<span class="nc" id="L142">		System.out.println(&quot;Note  : Tools for transform plain text file into Excelfile(.xlsx)&quot;);</span>
<span class="nc" id="L143">		System.out.println();</span>
<span class="nc" id="L144">		System.out.println(&quot;Usage : java -jar Data2Excel_v0.3.jar &lt;options...&gt;&quot;);</span>
<span class="nc" id="L145">		System.out.println(&quot;\t-i, --infile      \t&lt;File&gt;  \tInput plain text files. Support multiple files input(exampleï¼š\&quot;-i file1 -i file2\&quot;). [required]&quot;);</span>
<span class="nc" id="L146">		System.out.println(&quot;\t-o, --outfile     \t&lt;File&gt;  \tOutput Excel file, multi input will be writed into different sheets in the same workbook. [file1.xlsx]&quot;);</span>
<span class="nc" id="L147">		System.out.println(&quot;\t-f, --format      \t&lt;File&gt;  \tThe format file to set sheet column style. [not using]&quot;);</span>
<span class="nc" id="L148">		System.out.println(&quot;\t-s, --sheet_name  \t&lt;String&gt;\tTo set sheet name. When have more than one files, you need use it as \&quot;-s name1,name2\&quot;. [not using]&quot;);</span>
<span class="nc" id="L149">		System.out.println(&quot;\t-F, --split       \t&lt;String&gt;\tSplit char. (example: ' -F \&quot;\\t\&quot; ') [\\t]&quot;);</span>
<span class="nc" id="L150">		System.out.println(&quot;\t-c, --no_color    \t        \tTo close the color display in the output file. [not using]&quot;);</span>
<span class="nc" id="L151">		System.out.println(&quot;\t-e, --in_excel_col\t&lt;int&gt;   \tIn_Excel column index (0-base). Use it without argument will check 'In_Excel' in header line. [not using]&quot;);</span>
<span class="nc" id="L152">		System.out.println(&quot;\t-p, --print_sheet \t&lt;int&gt;   \tThe index(0-base) of Sheet to print. Be effective when the input is excel file. [print sheet name]&quot;);</span>
<span class="nc" id="L153">		System.out.println(&quot;\t-h, --help        \t        \tPrint this help.&quot;);</span>
<span class="nc" id="L154">		System.out.println();</span>
<span class="nc" id="L155">		System.exit(0);</span>
<span class="nc" id="L156">	}</span>
	public static int checkInExcel(String[] strArray)
	{
<span class="fc bfc" id="L159" title="All 2 branches covered.">		for (int j = 0; j &lt; strArray.length; j++) {</span>
<span class="fc" id="L160">			strArray[j].trim();</span>
<span class="pc bpc" id="L161" title="1 of 2 branches missed.">			if(strArray[j].compareTo(&quot;InExcel&quot;) == 0)</span>
<span class="nc" id="L162">				return j;</span>
		}
<span class="fc" id="L164">		return -1;</span>
	}

	public static void outLine2Row(String[] strArr, XSSFRow row) {
<span class="nc bnc" id="L168" title="All 2 branches missed.">		for (int j = 0; j &lt; strArr.length; j++) {</span>

<span class="nc" id="L170">			XSSFCell cell = row.createCell(j);</span>
<span class="nc" id="L171">			cell.setCellValue(strArr[j].trim());</span>
//			col_width[j] = col_width[j] &gt;= strArr[j].length() ? col_width[j] : strArr[j].length();
		}
		
<span class="nc" id="L175">	}</span>
	public static void outLine2Row(String[] strArr, XSSFRow row, CellStyle style) {
<span class="nc bnc" id="L177" title="All 2 branches missed.">		for (int j = 0; j &lt; strArr.length; j++) {</span>
			
<span class="nc" id="L179">			XSSFCell cell = row.createCell(j);</span>
<span class="nc" id="L180">			cell.setCellValue(strArr[j].trim());</span>
<span class="nc" id="L181">			cell.setCellStyle(style);</span>
//			col_width[j] = col_width[j] &gt;= strArr[j].length() ? col_width[j] : strArr[j].length();
		}
<span class="nc" id="L184">	}</span>
	
	public static void deleteArrElement(String[] strArray,String[] strArr, int index) {
<span class="nc" id="L187">		int len = strArray.length,n=0;</span>
<span class="nc bnc" id="L188" title="All 2 branches missed.">		for (int i = 0; i &lt; len; i++) {</span>
<span class="nc bnc" id="L189" title="All 2 branches missed.">			if(i == index) continue;</span>
<span class="nc" id="L190">			strArr[n++] = strArray[i];</span>
		}
<span class="nc" id="L192">	}</span>

	public static void setColumnFormat(XSSFSheet sheet, String[] header, ReadText myData)
	{
<span class="nc" id="L196">		Map &lt;String,int[]&gt; format = new HashMap &lt;String,int[]&gt;(); </span>
<span class="nc bnc" id="L197" title="All 2 branches missed.">		if(formatfile != null) format = myData.readFormatSet(formatfile);</span>
<span class="nc" id="L198">		short[] groupRegionList = new short[100];</span>
<span class="nc" id="L199">		short[] groupRegion = new short[]{-1,-1};</span>
<span class="nc" id="L200">		short[] groupRegionLevel = new short[]{-1,-1};</span>
<span class="nc" id="L201">		int regionIndex = 0;</span>
<span class="nc bnc" id="L202" title="All 2 branches missed.">		for(int j=0;j&lt;header.length;j++)</span>
		{
<span class="nc bnc" id="L204" title="All 2 branches missed.">			if(!format.containsKey('&quot;'+header[j]+'&quot;')) </span>
			{
<span class="nc" id="L206">				continue;				</span>
			}
			
<span class="nc" id="L209">			sheet.setColumnWidth(j,format.get('&quot;'+header[j]+'&quot;')[0]*256);</span>
<span class="nc bnc" id="L210" title="All 2 branches missed.">			if(format.get('&quot;'+header[j]+'&quot;')[1] == 1 )</span>
			{
<span class="nc bnc" id="L212" title="All 2 branches missed.">				if(groupRegion[1]==-1){</span>
<span class="nc bnc" id="L213" title="All 2 branches missed.">					if(groupRegion[0] == -1) groupRegion[0] = (short)j; </span>
<span class="nc" id="L214">					else groupRegion[1] = (short)j;</span>
				}
<span class="nc bnc" id="L216" title="All 2 branches missed.">				else if((j-groupRegion[1]) == 1){</span>
<span class="nc" id="L217">					groupRegion[1] = (short)j;</span>
				}
				else{
<span class="nc" id="L220">					groupRegionList[regionIndex++] = groupRegion[0];</span>
<span class="nc" id="L221">					groupRegionList[regionIndex++] = groupRegion[1];</span>
<span class="nc" id="L222">					groupRegion[0] = (short)j;</span>
<span class="nc" id="L223">					groupRegion[1] = (short)j;</span>
				}
			}
			
			//level 
<span class="nc bnc" id="L228" title="All 2 branches missed.">			if(format.get('&quot;'+header[j]+'&quot;')[2] == 2 )</span>
			{
<span class="nc bnc" id="L230" title="All 2 branches missed.">				if(groupRegionLevel[1]==-1){</span>
<span class="nc bnc" id="L231" title="All 2 branches missed.">					if(groupRegionLevel[0] == -1) groupRegionLevel[0] = (short)j; </span>
<span class="nc" id="L232">					else groupRegionLevel[1] = (short)j;</span>
				}
<span class="nc bnc" id="L234" title="All 2 branches missed.">				else if((j-groupRegionLevel[1]) == 1){</span>
<span class="nc" id="L235">					groupRegionLevel[1] = (short)j;</span>
				}
				else{
<span class="nc" id="L238">					groupRegionList[regionIndex++] = groupRegionLevel[0];</span>
<span class="nc" id="L239">					groupRegionList[regionIndex++] = groupRegionLevel[1];</span>
<span class="nc" id="L240">					groupRegionLevel[0] = (short)j;</span>
<span class="nc" id="L241">					groupRegionLevel[1] = (short)j;</span>
				}
			}
			
		}
<span class="nc bnc" id="L246" title="All 2 branches missed.">		if(groupRegion[1] != -1){</span>
<span class="nc" id="L247">			groupRegionList[regionIndex++] = groupRegion[0];</span>
<span class="nc" id="L248">			groupRegionList[regionIndex++] = groupRegion[1];</span>
		}
<span class="nc bnc" id="L250" title="All 2 branches missed.">		if(groupRegionLevel[1] != -1){</span>
<span class="nc" id="L251">			groupRegionList[regionIndex++] = groupRegionLevel[0];</span>
<span class="nc" id="L252">			groupRegionList[regionIndex++] = groupRegionLevel[1];</span>
		}
		
<span class="nc bnc" id="L255" title="All 2 branches missed.">		for(int k=0;k&lt;regionIndex;k+=2)</span>
		{
//			System.out.println(groupRegionList[k]+&quot;\t&quot;+groupRegionList[k+1]);
<span class="nc" id="L258">			sheet.groupColumn(groupRegionList[k], groupRegionList[k+1]);</span>
//			sheet.setColumnGroupCollapsed((short)0, false);
		}
<span class="nc" id="L261">	}</span>
	
	public static void writeToSheet(XSSFSheet sheet, String infile, CellStyle headerStyle, CellStyle textStyle){
<span class="nc" id="L264">		int n = 0, col_num = 0;</span>
<span class="nc" id="L265">		ReadText myData = new ReadText();		</span>
<span class="nc" id="L266">		Iterator&lt;String[]&gt; i = myData.readDataToLineArray(infile);</span>
//		Map &lt;String,int[]&gt; format = new HashMap &lt;String,int[]&gt;();
//		if(formatfile != null) format = myData.readFormatSet(formatfile);
<span class="nc" id="L269">		String[] header = new String[myData.max_col];</span>
<span class="nc" id="L270">		boolean hasHeader = false;</span>

<span class="nc bnc" id="L272" title="All 2 branches missed.">		while (i.hasNext()) {</span>
			
<span class="nc" id="L274">			String[] lineArr = i.next();</span>
<span class="nc bnc" id="L275" title="All 2 branches missed.">			if (lineArr[0].startsWith(&quot;##&quot;)) continue;			</span>
<span class="nc" id="L276">			col_num = lineArr.length;</span>
<span class="nc" id="L277">			XSSFRow row = null;</span>
			
<span class="nc bnc" id="L279" title="All 2 branches missed.">			if( col_num == 1)</span>
			{
<span class="nc" id="L281">				CellRangeAddress r_merge = new CellRangeAddress(n, n, 0, myData.max_col-1);</span>
<span class="nc" id="L282">				sheet.addMergedRegion(r_merge);</span>
			}

<span class="nc bnc" id="L285" title="All 2 branches missed.">			if (lineArr[0].startsWith(&quot;#&quot;)) {</span>
<span class="nc" id="L286">				lineArr[0] = lineArr[0].substring(1);</span>
<span class="nc" id="L287">				header = lineArr;</span>
<span class="nc" id="L288">				hasHeader = true;</span>
<span class="nc" id="L289">				row = sheet.createRow(n++);</span>
<span class="nc" id="L290">				outLine2Row(lineArr, row, headerStyle);</span>
<span class="nc" id="L291">				CellRangeAddress range = new CellRangeAddress(0, n - 1, 0, col_num - 1);</span>
<span class="nc" id="L292">				sheet.setAutoFilter(range);</span>
<span class="nc" id="L293">				sheet.createFreezePane(0,1);</span>
<span class="nc" id="L294">				continue;</span>
			}
			
<span class="nc" id="L297">			row = sheet.createRow(n++);</span>
<span class="nc bnc" id="L298" title="All 4 branches missed.">			if (no_color || n % 2 != 0)</span>
<span class="nc" id="L299">				outLine2Row(lineArr, row);</span>
			else
<span class="nc" id="L301">				outLine2Row(lineArr, row, textStyle);</span>
<span class="nc" id="L302">		}</span>
<span class="nc bnc" id="L303" title="All 4 branches missed.">		if(hasHeader &amp;&amp; formatfile != null)		</span>
<span class="nc" id="L304">			setColumnFormat(sheet,header,myData);</span>
		
<span class="nc" id="L306">	}</span>
	
	public static int writeToSheet(XSSFSheet sheet, String infile, CellStyle headerStyle, CellStyle textStyle, int in_excel){
<span class="nc" id="L309">		int n = 0;</span>
<span class="nc" id="L310">		ReadText myData = new ReadText();		</span>
<span class="nc" id="L311">		Iterator&lt;String[]&gt; i = myData.readDataToLineArray(infile);</span>
<span class="nc" id="L312">		String[] header = new String[myData.max_col];</span>
<span class="nc" id="L313">		boolean hasHeader = false;</span>
		
<span class="nc bnc" id="L315" title="All 2 branches missed.">		while (i.hasNext()) {</span>
<span class="nc" id="L316">			String[] lineArr = i.next();</span>
<span class="nc bnc" id="L317" title="All 2 branches missed.">			if (lineArr[0].startsWith(&quot;##&quot;)) continue;			</span>
<span class="nc" id="L318">			String[] strArr = new String[lineArr.length-1];</span>
<span class="nc" id="L319">			XSSFRow row = null;</span>
			
<span class="nc bnc" id="L321" title="All 2 branches missed.">			if (lineArr[0].startsWith(&quot;#&quot;)) {</span>
<span class="nc bnc" id="L322" title="All 2 branches missed.">				if(in_excel == -1 )</span>
<span class="nc" id="L323">					in_excel = checkInExcel(lineArr);</span>
<span class="nc" id="L324">				lineArr[0] = lineArr[0].substring(1);</span>
<span class="nc" id="L325">				row = sheet.createRow(n++);</span>
<span class="nc" id="L326">				deleteArrElement(lineArr,strArr,in_excel);</span>
<span class="nc" id="L327">				outLine2Row(strArr, row, headerStyle);</span>
<span class="nc" id="L328">				CellRangeAddress range = new CellRangeAddress(0, n - 1, 0, myData.max_col - 1);</span>
<span class="nc" id="L329">				sheet.setAutoFilter(range);</span>
<span class="nc" id="L330">				sheet.createFreezePane(0,1);</span>
				
<span class="nc" id="L332">				header = strArr;</span>
<span class="nc" id="L333">				hasHeader = true;</span>
<span class="nc" id="L334">				continue;</span>
			}
			
<span class="nc bnc" id="L337" title="All 2 branches missed.">			if( in_excel == -1 ) return -1;</span>
<span class="nc" id="L338">			int bool = Integer.parseInt(lineArr[in_excel]);</span>
<span class="nc bnc" id="L339" title="All 2 branches missed.">			if(bool == 1){</span>
<span class="nc" id="L340">				deleteArrElement(lineArr,strArr,in_excel);</span>
<span class="nc" id="L341">				row = sheet.createRow(n++);</span>
<span class="nc bnc" id="L342" title="All 4 branches missed.">				if (no_color || n % 2 != 0)</span>
<span class="nc" id="L343">					outLine2Row(strArr, row);</span>
				else
<span class="nc" id="L345">					outLine2Row(strArr, row, textStyle);</span>
			}
<span class="nc bnc" id="L347" title="All 2 branches missed.">			else if( bool != 0 ){</span>
<span class="nc" id="L348">				System.err.println(&quot;The inExcel column has an error!&quot;);</span>
<span class="nc" id="L349">				System.exit(1);</span>
			}
			
<span class="nc" id="L352">		}</span>
		
<span class="nc bnc" id="L354" title="All 4 branches missed.">		if(hasHeader &amp;&amp; formatfile != null) 		</span>
<span class="nc" id="L355">			setColumnFormat(sheet,header,myData);</span>
//		else{
//			for(int j=0;j&lt;myData.max_col;j++)
//			{
//				sheet.setColumnWidth(j, col_width[j]*256);
//			}
//		}
<span class="nc" id="L362">		return 0;</span>
		
	}
	
	

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>